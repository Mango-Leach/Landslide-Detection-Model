<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IntelliSlide</title>
    
    <!-- Load theme BEFORE CSS to prevent flash -->
    <script>
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.3.1/dist/chartjs-adapter-luxon.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <!-- Sidebar Navigation -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <i class="fas fa-microchip"></i>
            <h2>Analytics</h2>
        </div>
        <nav class="sidebar-nav">
            <a href="#overview" class="nav-item active" onclick="switchView('overview')">
                <i class="fas fa-chart-line"></i>
                <span>Overview</span>
            </a>
            <a href="#analytics" class="nav-item" onclick="switchView('analytics')">
                <i class="fas fa-chart-bar"></i>
                <span>Analytics</span>
            </a>
            <a href="#realtime" class="nav-item" onclick="switchView('realtime')">
                <i class="fas fa-stream"></i>
                <span>Real-time</span>
            </a>
            <a href="#history" class="nav-item" onclick="switchView('history')">
                <i class="fas fa-history"></i>
                <span>History</span>
            </a>
            <a href="#settings" class="nav-item" onclick="switchView('settings')">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <div class="theme-toggle">
                <i class="fas fa-moon"></i>
                <label class="switch">
                    <input type="checkbox" id="themeToggle">
                    <span class="slider"></span>
                </label>
                <i class="fas fa-sun"></i>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <header class="top-header">
            <div class="header-left">
                <button class="menu-toggle" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <h1><i class="fas fa-chart-area"></i> IntelliSlide</h1>
            </div>
            <div class="header-right">
                <div class="status-badge">
                    <span class="status-indicator" id="statusIndicator"></span>
                    <span id="statusText">Connecting...</span>
                </div>
                <div class="header-actions">
                    <button class="icon-btn" id="voiceToggle" onclick="toggleVoiceAlerts()" title="Toggle Voice Alerts">
                        üîá Voice OFF
                    </button>
                    <button class="icon-btn" onclick="toggleNotifications()" title="Notifications">
                        <i class="fas fa-bell"></i>
                        <span class="badge" id="notificationBadge">0</span>
                    </button>
                    <button class="icon-btn" onclick="exportData('csv')" title="Export CSV">
                        <i class="fas fa-file-csv"></i>
                    </button>
                    <button class="icon-btn" onclick="exportData('pdf')" title="Export PDF">
                        <i class="fas fa-file-pdf"></i>
                    </button>
                    <button class="icon-btn" onclick="toggleFullscreen()" title="Fullscreen">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button class="icon-btn" onclick="logout()" title="Logout" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Notification Panel -->
        <div class="notification-panel" id="notificationPanel">
            <div class="notification-header">
                <h3><i class="fas fa-bell"></i> Notifications</h3>
                <button onclick="toggleNotifications()"><i class="fas fa-times"></i></button>
            </div>
            <div class="notification-list" id="notificationList">
                <p class="no-notifications">No new notifications</p>
            </div>
        </div>

        <!-- Overview Section -->
        <div class="view-section active" id="overview">
            <!-- Quick Stats -->
            <div class="stats-grid">
                <div class="stat-card temperature">
                    <div class="stat-header">
                        <i class="fas fa-temperature-high"></i>
                        <span>Temperature</span>
                    </div>
                    <div class="stat-body">
                        <h2 id="tempValue">--</h2>
                        <span class="unit">¬∞C</span>
                    </div>
                    <div class="stat-footer">
                        <span class="trend" id="tempTrend">
                            <i class="fas fa-arrow-up"></i> +0.5¬∞C
                        </span>
                        <span class="stat-label">vs last reading</span>
                    </div>
                    <div class="stat-mini-chart">
                        <canvas id="tempMiniChart"></canvas>
                    </div>
                </div>

                <div class="stat-card humidity">
                    <div class="stat-header">
                        <i class="fas fa-tint"></i>
                        <span>Humidity</span>
                    </div>
                    <div class="stat-body">
                        <h2 id="humidityValue">--</h2>
                        <span class="unit">%</span>
                    </div>
                    <div class="stat-footer">
                        <span class="trend" id="humidityTrend">
                            <i class="fas fa-minus"></i> 0.0%
                        </span>
                        <span class="stat-label">vs last reading</span>
                    </div>
                    <div class="stat-mini-chart">
                        <canvas id="humidityMiniChart"></canvas>
                    </div>
                </div>

                <div class="stat-card pressure">
                    <div class="stat-header">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Atmospheric Pressure</span>
                    </div>
                    <div class="stat-body">
                        <h2 id="pressureValue">--</h2>
                        <span class="unit">hPa</span>
                    </div>
                    <div class="stat-footer">
                        <span class="trend" id="pressureTrend">
                            <i class="fas fa-arrow-down"></i> -2 hPa
                        </span>
                        <span class="stat-label">vs last reading</span>
                    </div>
                    <div class="stat-mini-chart">
                        <canvas id="pressureMiniChart"></canvas>
                    </div>
                </div>

                <div class="stat-card rainfall">
                    <div class="stat-header">
                        <i class="fas fa-cloud-rain"></i>
                        <span>Rainfall Data</span>
                    </div>
                    <div class="stat-body">
                        <h2 id="rainfallValue">--</h2>
                        <span class="unit">mm/hr</span>
                    </div>
                    <div class="stat-footer">
                        <span class="stat-label">24h: <strong id="rainfall24h">0.0</strong> mm</span>
                        <span class="stat-label">48h: <strong id="rainfall48h">0.0</strong> mm</span>
                    </div>
                    <div class="stat-mini-chart">
                        <div style="font-size: 11px; color: #888; margin-top: 5px;">
                            üìç <span id="rainfallLocation">Loading...</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card data-points">
                    <div class="stat-header">
                        <i class="fas fa-database"></i>
                        <span>Data Points</span>
                    </div>
                    <div class="stat-body">
                        <h2 id="dataPoints">0</h2>
                        <span class="unit">total</span>
                    </div>
                    <div class="stat-footer">
                        <span class="stat-label">Update Rate:</span>
                        <span class="trend" id="updateRate">-- /sec</span>
                    </div>
                    <div class="stat-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="dataProgress" style="width: 0%"></div>
                        </div>
                        <span class="progress-text">0% of capacity</span>
                    </div>
                </div>
                </div>

            <!-- üåã AI Landslide Prediction Section -->
            <div class="charts-row">
                <div class="chart-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
                    <div class="chart-header" style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                        <h3><i class="fas fa-brain"></i> üåã AI Landslide Prediction</h3>
                        <button class="icon-btn-sm" onclick="refreshLandslidePrediction()" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                    <div class="chart-body" style="padding: 25px;">
                        <div id="ai-prediction-content">
                            <div style="text-align: center; padding: 20px;">
                                <div style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 15px;">
                                    <i class="fas fa-spinner fa-spin"></i> Loading AI prediction...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none;">
                    <div class="chart-header" style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                        <h3><i class="fas fa-exclamation-triangle"></i> Pattern Detection</h3>
                        <button class="icon-btn-sm" onclick="refreshLandslidePrediction()" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                    <div class="chart-body" style="padding: 25px;">
                        <div id="pattern-detection-content">
                            <div style="text-align: center; padding: 20px;">
                                <div style="font-size: 0.9rem; opacity: 0.9;">
                                    <i class="fas fa-spinner fa-spin"></i> Analyzing patterns...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ÔøΩ PATENT FEATURES: Enhanced Risk Assessment & Safe Zones -->
            <div class="charts-row">
                <div class="chart-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); color: #2d3748; border: none;">
                    <div class="chart-header" style="border-bottom: 1px solid rgba(0,0,0,0.1);">
                        <h3><i class="fas fa-shield-alt"></i> üöÄ Enhanced Risk Assessment</h3>
                        <button class="icon-btn-sm" onclick="refreshEnhancedRisk()" style="background: rgba(255,255,255,0.5);">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                    <div class="chart-body" style="padding: 20px;">
                        <div id="enhanced-risk-content">
                            <div style="text-align: center; padding: 15px;">
                                <div style="font-size: 0.9rem; opacity: 0.8;">
                                    <i class="fas fa-spinner fa-spin"></i> Calculating combined risk...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chart-card" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); color: white; border: none;">
                    <div class="chart-header" style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                        <h3><i class="fas fa-cloud-rain"></i> üåßÔ∏è Rainfall Forecast</h3>
                        <button class="icon-btn-sm" onclick="refreshRainfallForecast()" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                    <div class="chart-body" style="padding: 20px;">
                        <div id="rainfall-forecast-content">
                            <div style="text-align: center; padding: 15px;">
                                <div style="font-size: 0.9rem; opacity: 0.9;">
                                    <i class="fas fa-spinner fa-spin"></i> Loading weather data...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- üó∫Ô∏è 3D Terrain Mapping & Weak Point Detection -->
            <div class="charts-row">
                <div class="chart-card large" style="background: linear-gradient(135deg, #232526 0%, #414345 100%); color: white; border: none; position: relative;">
                    <div class="chart-header" style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                        <h3><i class="fas fa-mountain"></i> üó∫Ô∏è 3D Terrain Analysis & Weak Points</h3>
                        <button class="icon-btn-sm" onclick="updateTerrainMap()" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                    <div class="chart-body" style="padding: 0; min-height: 500px; position: relative; overflow: hidden;">
                        <!-- Device Location Input Panel -->
                        <div style="position: absolute; top: 15px; right: 15px; z-index: 10; background: rgba(0,0,0,0.85); padding: 15px; border-radius: 8px; border: 2px solid #4CAF50; max-width: 300px;">
                            <div style="font-size: 14px; font-weight: bold; margin-bottom: 10px; color: #4CAF50;">
                                <i class="fas fa-map-pin"></i> DEVICE LOCATION
                            </div>
                            <div style="margin-bottom: 8px;">
                                <label style="font-size: 10px; opacity: 0.7; display: block; margin-bottom: 3px;">Device ID:</label>
                                <input type="text" id="terrain-device-name" value="ESP32-SLOPE-MONITOR" 
                                    style="width: 100%; padding: 6px; background: rgba(255,255,255,0.1); border: 1px solid #555; color: white; font-size: 11px; border-radius: 4px;">
                            </div>
                            <div style="margin-bottom: 8px;">
                                <label style="font-size: 10px; opacity: 0.7; display: block; margin-bottom: 3px;">Latitude:</label>
                                <input type="number" id="terrain-latitude" value="30.0668" step="0.0001"
                                    style="width: 100%; padding: 6px; background: rgba(255,255,255,0.1); border: 1px solid #555; color: white; font-size: 11px; border-radius: 4px;">
                            </div>
                            <div style="margin-bottom: 8px;">
                                <label style="font-size: 10px; opacity: 0.7; display: block; margin-bottom: 3px;">Longitude:</label>
                                <input type="number" id="terrain-longitude" value="79.0193" step="0.0001"
                                    style="width: 100%; padding: 6px; background: rgba(255,255,255,0.1); border: 1px solid #555; color: white; font-size: 11px; border-radius: 4px;">
                            </div>
                            <div style="margin-bottom: 12px;">
                                <label style="font-size: 10px; opacity: 0.7; display: block; margin-bottom: 3px;">Elevation (m):</label>
                                <input type="number" id="terrain-elevation" value="2500" step="1"
                                    style="width: 100%; padding: 6px; background: rgba(255,255,255,0.1); border: 1px solid #555; color: white; font-size: 11px; border-radius: 4px;">
                            </div>
                            <button onclick="updateTerrainMap()" 
                                style="width: 100%; padding: 8px; background: linear-gradient(135deg, #4CAF50, #45a049); border: none; color: white; font-size: 11px; font-weight: bold; cursor: pointer; border-radius: 4px;">
                                ‚ö° UPDATE TERRAIN
                            </button>
                            <div id="terrain-coords-display" style="margin-top: 10px; padding: 8px; background: rgba(76, 175, 80, 0.15); border: 1px solid #4CAF50; font-size: 9px; border-radius: 4px;">
                                <div style="font-weight: bold; margin-bottom: 3px;">COORDINATES LOCKED</div>
                                <div>LAT: 30.0668¬∞N | LON: 79.0193¬∞E</div>
                                <div>ZONE: <span id="terrain-region-name">UTTARAKHAND</span></div>
                                <div style="margin-top: 5px; color: #ff9800;">
                                    <i class="fas fa-exclamation-triangle"></i> 
                                    WEAK POINTS: <span id="terrain-weak-count">0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Terrain Legend -->
                        <div style="position: absolute; bottom: 15px; left: 15px; z-index: 10; background: rgba(0,0,0,0.85); padding: 12px; border-radius: 8px; border: 1px solid #555;">
                            <div style="font-size: 11px; font-weight: bold; margin-bottom: 8px; color: #4CAF50;">TERRAIN LEGEND</div>
                            <div style="display: flex; align-items: center; margin-bottom: 4px; font-size: 9px;">
                                <div style="width: 20px; height: 12px; background: #ff0000; margin-right: 8px; border: 1px solid #333;"></div>
                                <span>CRITICAL (>45¬∞ slope)</span>
                            </div>
                            <div style="display: flex; align-items: center; margin-bottom: 4px; font-size: 9px;">
                                <div style="width: 20px; height: 12px; background: #ff4400; margin-right: 8px; border: 1px solid #333;"></div>
                                <span>HIGH RISK (30-45¬∞)</span>
                            </div>
                            <div style="display: flex; align-items: center; margin-bottom: 4px; font-size: 9px;">
                                <div style="width: 20px; height: 12px; background: #ffaa00; margin-right: 8px; border: 1px solid #333;"></div>
                                <span>MODERATE (15-30¬∞)</span>
                            </div>
                            <div style="display: flex; align-items: center; margin-bottom: 4px; font-size: 9px;">
                                <div style="width: 20px; height: 12px; background: #00ff00; margin-right: 8px; border: 1px solid #333;"></div>
                                <span>STABLE (<15¬∞)</span>
                            </div>
                            <div style="display: flex; align-items: center; font-size: 9px; padding-top: 6px; border-top: 1px solid #555; margin-top: 6px;">
                                <div style="width: 12px; height: 12px; background: #ff0000; border-radius: 50%; margin-right: 8px; box-shadow: 0 0 10px #ff0000;"></div>
                                <span>WEAK POINTS DETECTED</span>
                            </div>
                        </div>

                        <!-- 3D Terrain Canvas -->
                        <canvas id="terrain-3d-canvas" style="width: 100%; height: 500px; display: block;"></canvas>
                    </div>
                </div>
            </div>

            <!-- Main Charts -->
            <div class="charts-row">
                <div class="chart-card large">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-line"></i> Temperature & Humidity Timeline</h3>
                        <div class="chart-controls">
                            <select id="timeRangeSelect" onchange="updateTimeRange()">
                                <option value="10">Last 10 min</option>
                                <option value="30" selected>Last 30 min</option>
                                <option value="60">Last 1 hour</option>
                                <option value="180">Last 3 hours</option>
                                <option value="all">All time</option>
                            </select>
                            <button class="icon-btn-sm" onclick="downloadChart('tempHumidityChart')" title="Download">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="tempHumidityChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-tachometer-alt"></i> Atmospheric Pressure Analysis</h3>
                        <button class="icon-btn-sm" onclick="downloadChart('pressureChart')">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                    <div class="chart-body">
                        <canvas id="pressureChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Secondary Charts -->
            <div class="charts-row">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-pie"></i> Sensor Distribution</h3>
                    </div>
                    <div class="chart-body">
                        <canvas id="pieChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-bar"></i> Current Readings</h3>
                    </div>
                    <div class="chart-body">
                        <canvas id="barChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-area"></i> Heatmap</h3>
                    </div>
                    <div class="chart-body">
                        <canvas id="radarChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Section -->
        <div class="view-section" id="analytics">
            <h2 class="section-title"><i class="fas fa-chart-bar"></i> Advanced Analytics</h2>
            
            <div class="analytics-grid">
                <div class="analytics-card">
                    <h3><i class="fas fa-calculator"></i> Statistical Summary</h3>
                    <div class="stats-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Temperature</th>
                                    <th>Humidity</th>
                                    <th>Pressure</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Average</strong></td>
                                    <td id="avgTemp">--</td>
                                    <td id="avgHumidity">--</td>
                                    <td id="avgPressure">--</td>
                                </tr>
                                <tr>
                                    <td><strong>Minimum</strong></td>
                                    <td id="minTemp">--</td>
                                    <td id="minHumidity">--</td>
                                    <td id="minPressure">--</td>
                                </tr>
                                <tr>
                                    <td><strong>Maximum</strong></td>
                                    <td id="maxTemp">--</td>
                                    <td id="maxHumidity">--</td>
                                    <td id="maxPressure">--</td>
                                </tr>
                                <tr>
                                    <td><strong>Std Dev</strong></td>
                                    <td id="stdTemp">--</td>
                                    <td id="stdHumidity">--</td>
                                    <td id="stdPressure">--</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="analytics-card">
                    <h3><i class="fas fa-exclamation-triangle"></i> Alerts & Thresholds</h3>
                    <div class="threshold-settings">
                        <div class="threshold-item">
                            <label>Temperature Max (¬∞C)</label>
                            <input type="number" id="tempMax" value="30" onchange="updateThresholds()">
                        </div>
                        <div class="threshold-item">
                            <label>Humidity Max (%)</label>
                            <input type="number" id="humidityMax" value="80" onchange="updateThresholds()">
                        </div>
                        <div class="threshold-item">
                            <label>Pressure Min (hPa)</label>
                            <input type="number" id="pressureMin" value="980" onchange="updateThresholds()">
                        </div>
                        <div class="threshold-item">
                            <label>Pressure Max (hPa)</label>
                            <input type="number" id="pressureMax" value="1050" onchange="updateThresholds()">
                        </div>
                    </div>
                    <div class="alert-list" id="alertList">
                        <p class="no-alerts">No active alerts</p>
                    </div>
                </div>
            </div>

            <div class="chart-card large">
                <div class="chart-header">
                    <h3><i class="fas fa-project-diagram"></i> Correlation Analysis</h3>
                </div>
                <div class="chart-body">
                    <canvas id="scatterChart"></canvas>
                </div>
            </div>

            <!-- Enhanced Visualizations -->
            <h2 class="section-title" style="margin-top: 30px;"><i class="fas fa-fire"></i> Enhanced Visualizations</h2>
            
            <div class="charts-row">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-th"></i> Temperature Heatmap</h3>
                        <div class="chart-controls">
                            <select id="heatmapRange" onchange="updateHeatmap()">
                                <option value="24">Last 24 hours</option>
                                <option value="12" selected>Last 12 hours</option>
                                <option value="6">Last 6 hours</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="heatmapChart" height="300"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-area"></i> Multi-Sensor Comparison</h3>
                        <div class="chart-controls">
                            <button class="icon-btn-sm" onclick="toggleComparisonView()" title="Toggle View">
                                <i class="fas fa-sync"></i>
                            </button>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="charts-row">
                <div class="chart-card large">
                    <div class="chart-header">
                        <h3><i class="fas fa-clock"></i> Hourly Average Comparison</h3>
                        <div class="chart-controls">
                            <label style="margin-right: 10px; color: var(--text);">
                                <input type="checkbox" id="showTemp" checked onchange="updateComparisonChart()"> Temperature
                            </label>
                            <label style="margin-right: 10px; color: var(--text);">
                                <input type="checkbox" id="showHumidity" checked onchange="updateComparisonChart()"> Humidity
                            </label>
                            <label style="color: var(--text);">
                                <input type="checkbox" id="showPressure" checked onchange="updateComparisonChart()"> Pressure
                            </label>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="hourlyChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Real-time Section -->
        <div class="view-section" id="realtime">
            <h2 class="section-title"><i class="fas fa-stream"></i> Real-time Data Stream</h2>
            
            <div class="realtime-container">
                <div class="gauge-grid">
                    <div class="gauge-card">
                        <h3>Temperature</h3>
                        <canvas id="tempGauge"></canvas>
                    </div>
                    <div class="gauge-card">
                        <h3>Humidity</h3>
                        <canvas id="humidityGauge"></canvas>
                    </div>
                    <div class="gauge-card">
                        <h3>Atmospheric Pressure</h3>
                        <canvas id="pressureGauge"></canvas>
                    </div>
                </div>

                <div class="live-feed">
                    <h3><i class="fas fa-rss"></i> Live Data Feed</h3>
                    <div class="feed-container" id="liveFeed">
                        <p class="no-data">Waiting for data...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- History Section -->
        <div class="view-section" id="history">
            <h2 class="section-title"><i class="fas fa-history"></i> Historical Data</h2>
            
            <div class="data-table-container">
                <div class="table-controls">
                    <div class="table-actions">
                        <button class="btn btn-primary" onclick="exportData('csv')">
                            <i class="fas fa-file-csv"></i> Export CSV
                        </button>
                        <button class="btn btn-danger" onclick="exportData('pdf')">
                            <i class="fas fa-file-pdf"></i> Export PDF
                        </button>
                        <button class="btn btn-warning" onclick="exportData('json')">
                            <i class="fas fa-file-code"></i> Export JSON
                        </button>
                        <button class="btn btn-dark" onclick="clearData()">
                            <i class="fas fa-trash"></i> Clear Data
                        </button>
                    </div>
                    <div class="table-filter">
                        <input type="text" id="tableSearch" placeholder="Filter data..." onkeyup="filterTable()">
                        <select id="rowsPerPage" onchange="changeRowsPerPage()">
                            <option value="10">10 rows</option>
                            <option value="25" selected>25 rows</option>
                            <option value="50">50 rows</option>
                            <option value="100">100 rows</option>
                            <option value="all">All</option>
                        </select>
                    </div>
                </div>
                <div class="table-wrapper">
                    <table id="dataTable">
                        <thead>
                            <tr>
                                <th onclick="sortTable(0)">Timestamp <i class="fas fa-sort"></i></th>
                                <th onclick="sortTable(1)">Temperature (¬∞C) <i class="fas fa-sort"></i></th>
                                <th onclick="sortTable(2)">Humidity (%) <i class="fas fa-sort"></i></th>
                                <th onclick="sortTable(3)">Pressure (hPa) <i class="fas fa-sort"></i></th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="dataTableBody">
                            <tr>
                                <td colspan="5" class="no-data">No data available yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="table-pagination" id="tablePagination"></div>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="view-section" id="settings">
            <h2 class="section-title"><i class="fas fa-cog"></i> Settings & Configuration</h2>
            
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-palette"></i> Appearance</h3>
                    <div class="setting-item">
                        <label>Theme</label>
                        <select id="themeSelect" onchange="changeTheme()">
                            <option value="light">Light</option>
                            <option value="dark">Dark</option>
                            <option value="auto">Auto</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label>Chart Animation</label>
                        <label class="switch">
                            <input type="checkbox" id="chartAnimation" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-clock"></i> Data Collection</h3>
                    <div class="setting-item">
                        <label>Auto-refresh</label>
                        <label class="switch">
                            <input type="checkbox" id="autoRefresh" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>Data Retention (points)</label>
                        <input type="number" id="dataRetention" value="1000" min="100" max="10000">
                    </div>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-bell"></i> Notifications</h3>
                    <div class="setting-item">
                        <label>Enable Alerts</label>
                        <label class="switch">
                            <input type="checkbox" id="enableAlerts" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>Sound Notifications</label>
                        <label class="switch">
                            <input type="checkbox" id="soundNotifications">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>üîä Voice Alerts</label>
                        <label class="switch">
                            <input type="checkbox" id="voiceAlertsToggle" onchange="toggleVoiceAlerts()">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <button onclick="testVoiceAlert()" style="padding: 8px 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            üé§ Test Voice Alert
                        </button>
                    </div>
                </div>

                <div class="settings-card">
                    <h3><i class="fas fa-info-circle"></i> System Info</h3>
                    <div class="info-list">
                        <div class="info-item">
                            <span>Version:</span>
                            <strong>2.0.0</strong>
                        </div>
                        <div class="info-item">
                            <span>Uptime:</span>
                            <strong id="uptime">--</strong>
                        </div>
                        <div class="info-item">
                            <span>Connection:</span>
                            <strong id="connectionInfo">WebSocket</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
